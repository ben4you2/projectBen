<!--<!DOCTYPE html>
<html lang="en" x-data="voterApp()" x-cloak>
<head>
    <!-- ... (head content remains the same) ... -->
        <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voter Registration System</title>
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üó≥Ô∏è</text></svg>">
    
    <style>
        [x-cloak] { display: none !important; }
        .avatar-preview { height: 100px; width: 100px; object-fit: cover; }
        .voter-enter-active { transition: all 0.3s ease-out; }
        .voter-enter-from { opacity: 0; transform: translateY(-20px); }
    </style>

</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-4xl" x-effect="initApp">
        <!-- ... (header and form sections remain the same) ... -->
        
                <!-- Header -->
        <header class="mb-12 text-center animate__animated animate__fadeIn">
          <div class="mb-6 inline-flex items-center gap-3">
            <span class="text-4xl">üó≥Ô∏è</span>
            <h1 class="text-3xl font-bold text-gray-800">National Voter Registry</h1>
          </div>
        </header>

        <!-- Registration Form -->
        <section class="bg-white rounded-xl shadow-lg p-6 mb-8 animate__animated animate__fadeInUp">
            <form @submit.prevent="registerVoter" class="space-y-4" id="registrationForm">
                <!-- Form fields remain the same -->
                <div class="flex gap-4">
                    <button type="button" 
                            @click="cancelEdit" 
                            x-show="state.isEditing" 
                            class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors">
                        Cancel
                    </button>
                    <button type="submit" 
                            x-text="state.isEditing ? 'Update Voter' : 'Register Voter'" 
                            class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                    </button>
                </div>
            </form>
        </section>

        <!-- ... (search/filter section remains the same) ... -->
        
        <!-- Search and Filter -->
        <div class="mb-6 flex flex-col md:flex-row gap-4 items-center justify-between">
            <div class="w-full md:w-64 relative">
                <input type="text" 
                    x-model="searchQuery" 
                    placeholder="Search voters..." 
                    class="w-full pl-10 pr-4 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-400 transition-all"
                    @input.debounce.300ms="applyFilters">
                <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
            </div>
            
            <div class="flex items-center gap-4 w-full md:w-auto">
                <select x-model="sortBy" 
                        @change="applyFilters"
                        class="px-4 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-400 transition-all">
                    <option value="name">Sort by Name</option>
                    <option value="age">Sort by Age</option>
                    <option value="idNumber">Sort by ID</option>
                </select>
                
                <span class="text-sm text-gray-600">
                    Showing <span x-text="filteredVoters.length"></span> voters
                </span>
            </div>
        </div>

        <!-- Voters List -->
        <section class="bg-white rounded-xl shadow-lg p-6 animate__animated animate__fadeInUp">
            <div id="votersList" class="space-y-4" x-data="{ selected: null }">
                <template x-for="(voter, index) in filteredVoters" :key="voter.idNumber">
                    <div class="voter-item bg-white rounded-lg p-4 flex items-start gap-4 transition-all hover:shadow-md border border-gray-100"
                        x-intersect.once="$el.classList.add('animate__fadeIn')">
                        <!-- ... (voter card content) ... -->
                        <div class="ml-auto flex gap-2">
                            <button @click="editVoter(voter.idNumber)" class="text-blue-600 hover:text-blue-800">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button @click="deleteVoter(voter.idNumber)" class="text-red-600 hover:text-red-800">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </template>
                <!-- ... (empty state remains the same) ... -->
                                <!-- Empty State -->
                <div x-show="filteredVoters.length === 0" 
                    class="text-center py-12 text-gray-500 animate__animated animate__fadeIn">
                    <i class="fas fa-user-slash text-4xl mb-4"></i>
                    <p class="text-lg">No voters found matching your criteria</p>
                </div>
            </div>
            </div>
        </section>
        <!-- ... (footer remains the same) ... -->
    </div>

    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.data('voterApp', () => ({
                voters: JSON.parse(localStorage.getItem('voters')) || [],
                state: {
                    formData: { name: '', idNumber: '', age: '', email: '', address: '', photo: '' },
                    photoPreview: null,
                    isEditing: false,
                    currentEditId: null
                },
                // ... (remaining variables remain the same) ...

                 /* ... (unchanged) ... */
                initApp() {
                    this.applyFilters();
                    this.$watch('voters', () => {
                        localStorage.setItem('voters', JSON.stringify(this.voters));
                        this.applyFilters();
                    });

                },

     applyFilters() { /* ... (unchanged) ... */ 
                  this.filteredVoters = this.voters.filter(voter => {
  const search = this.searchQuery.toLowerCase();
  return Object.values(voter).some(value =>
    String(value).toLowerCase().includes(search)
  );
}).sort((a, b) => {
  if (this.sortBy === 'name') return a.name.localeCompare(b.name);
  if (this.sortBy === 'age') return a.age - b.age;
  return a.idNumber.localeCompare(b.idNumber);
});
                },

                async deleteVoter(idNumber) {
                    const result = await Swal.fire({
                        title: 'Confirm Deletion',
                        text: "You won't be able to revert this!",
                        icon: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Yes, delete it!'
                    });

                    if (result.isConfirmed) {
                        const index = this.voters.findIndex(v => v.idNumber === idNumber);
                        if (index !== -1) this.voters.splice(index, 1);
                        Swal.fire('Deleted!', 'Voter record has been removed.', 'success');
                    }
                },

                editVoter(idNumber) {
                    const voter = this.voters.find(v => v.idNumber === idNumber);
                    if (!voter) return;
                    this.state.formData = { ...voter };
                    this.state.photoPreview = voter.photo;
                    this.state.isEditing = true;
                    this.state.currentEditId = idNumber;
                },

                cancelEdit() {
                    this.state.formData = { name: '', idNumber: '', age: '', email: '', address: '', photo: '' };
                    this.state.photoPreview = null;
                    this.state.isEditing = false;
                    this.state.currentEditId = null;
                },

                registerVoter() {
                    if (!this.validateForm()) return;

                    if (this.state.isEditing) {
                        const index = this.voters.findIndex(v => v.idNumber === this.state.currentEditId);
                        if (index !== -1) this.voters[index] = { ...this.state.formData };
                    } else {
                        this.voters.push({ ...this.state.formData });
                    }

                    this.cancelEdit();
                    this.applyFilters();
                },

                validateForm() {
                    const formData = this.state.formData;
                    // Required fields
                    if (!formData.name || !formData.idNumber || !formData.age || !formData.email || !formData.address) {
                        Swal.fire('Error', 'All fields are required!', 'error');
                        return false;
                    }
                    // Age validation
                    if (isNaN(formData.age) || formData.age < 18) {
                        Swal.fire('Error', 'Age must be at least 18!', 'error');
                        return false;
                    }
                    // ID validation
                    if (!/^\d+$/.test(formData.idNumber)) {
                        Swal.fire('Error', 'ID Number must be numeric!', 'error');
                        return false;
                    }
                    // Email validation
                    if (!/\S+@\S+\.\S+/.test(formData.email)) {
                        Swal.fire('Error', 'Invalid email format!', 'error');
                        return false;
                    }
                    // Duplicate check
                    const isDuplicate = this.voters.some(v => 
                        v.idNumber === formData.idNumber && 
                        (this.state.isEditing ? v.idNumber !== this.state.currentEditId : true)
                    );
                    if (isDuplicate) {
                        Swal.fire('Error', 'ID Number already exists!', 'error');
                        return false;
                    }
                    return true;
                },

                previewImage(event) {
                    const file = event.target.files[0];
                    if (!file) return;
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        this.state.photoPreview = e.target.result;
                        this.state.formData.photo = e.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            }));
        });
    </script>
</body>
</html>-->


<!DOCTYPE html>
<html lang="en" x-data="voterApp()" x-cloak>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voter Registration System</title>

    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        [x-cloak] { display: none !important; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-3xl" x-init="initApp">
        <header class="mb-8 text-center">
            <h1 class="text-3xl font-semibold text-gray-800">üó≥Ô∏è Voter Registration</h1>
        </header>

        <section class="bg-white rounded-lg shadow-md p-6">
            <form @submit.prevent="registerVoter">
                <input type="hidden" x-model="state.currentEditId">
                <div class="grid grid-cols-1 gap-4">
                    <label>Full Name</label>
                    <input type="text" x-model="state.formData.name" class="border rounded p-2" required>

                    <label>ID Number</label>
                    <input type="text" x-model="state.formData.idNumber" class="border rounded p-2" required>

                    <label>Age</label>
                    <input type="number" x-model="state.formData.age" class="border rounded p-2" min="18" required>

                    <label>Email</label>
                    <input type="email" x-model="state.formData.email" class="border rounded p-2" required>

                    <label>Address</label>
                    <input type="text" x-model="state.formData.address" class="border rounded p-2" required>

                    <button type="submit" class="bg-blue-600 text-white py-2 rounded">
                        <span x-text="state.isEditing ? 'Update Voter' : 'Register Voter'"></span>
                    </button>
                    <button type="button" x-show="state.isEditing" @click="cancelEdit" class="bg-gray-500 text-white py-2 rounded">Cancel</button>
                </div>
            </form>
        </section>

        <section class="bg-white rounded-lg shadow-md p-6 mt-4">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Registered Voters</h2>
            <div x-data="{ searchQuery: '' }">
                <input type="text" x-model="searchQuery" placeholder="Search..." class="border p-2 rounded w-full">
            </div>
            <div id="votersList" class="mt-4 space-y-4">
                <template x-for="(voter, index) in filteredVoters" :key="voter.idNumber">
                    <div class="border rounded-lg p-4 flex justify-between">
                        <div>
                            <p class="font-semibold" x-text="voter.name"></p>
                            <p class="text-sm text-gray-600">ID: <span x-text="voter.idNumber"></span></p>
                            <p class="text-sm text-gray-600" x-text="voter.age + ' years old'"></p>
                        </div>
                        <div class="flex gap-2">
                            <button @click="editVoter(voter.idNumber)" class="text-blue-500">Edit</button>
                            <button @click="deleteVoter(voter.idNumber)" class="text-red-500">Remove</button>
                        </div>
                    </div>
                </template>
                <p x-show="filteredVoters.length === 0" class="text-center text-gray-500">No voters found.</p>
            </div>
        </section>
    </div>

    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.data('voterApp', () => ({
                voters: JSON.parse(localStorage.getItem('voters')) || [],
                state: {
                    formData: { name: '', idNumber: '', age: '', email: '', address: '' },
                    isEditing: false,
                    currentEditId: null
                },
                filteredVoters: [],

                initApp() {
                    this.applyFilters();
                    this.$watch('voters', () => {
                        localStorage.setItem('voters', JSON.stringify(this.voters));
                        this.applyFilters();
                    });
                },

                applyFilters() {
                    this.filteredVoters = this.voters.filter(voter =>
                        voter.name.toLowerCase().includes(this.searchQuery.toLowerCase()) ||
                        voter.idNumber.toLowerCase().includes(this.searchQuery.toLowerCase())
                    );
                },

                deleteVoter(idNumber) {
                    Swal.fire({
                        title: 'Confirm Deletion',
                        text: "Are you sure you want to delete this voter?",
                        icon: 'warning',
                        showCancelButton: true,
                        confirmButtonText: 'Yes, delete it!',
                        cancelButtonText: 'Cancel'
                    }).then(result => {
                        if (result.isConfirmed) {
                            this.voters = this.voters.filter(voter => voter.idNumber !== idNumber);
                            this.applyFilters();
                            Swal.fire('Deleted!', 'Voter has been removed.', 'success');
                        }
                    });
                },

                editVoter(idNumber) {
                    const voter = this.voters.find(v => v.idNumber === idNumber);
                    if (voter) {
                        this.state.formData = { ...voter };
                        this.state.isEditing = true;
                        this.state.currentEditId = idNumber;
                    }
                },

                cancelEdit() {
                    this.state.formData = { name: '', idNumber: '', age: '', email: '', address: '' };
                    this.state.isEditing = false;
                    this.state.currentEditId = null;
                },

                registerVoter() {
                    if (!this.validateForm()) return;

                    if (this.state.isEditing) {
                        const index = this.voters.findIndex(v => v.idNumber === this.state.currentEditId);
                        if (index !== -1) this.voters[index] = { ...this.state.formData };
                    } else {
                        const isDuplicate = this.voters.some(v => v.idNumber === this.state.formData.idNumber);
                        if (isDuplicate) {
                            Swal.fire('Error', 'ID Number already exists!', 'error');
                            return;
                        }
                        this.voters.push({ ...this.state.formData });
                    }

                    this.cancelEdit();
                    this.applyFilters();
                },

                validateForm() {
                    const formData = this.state.formData;
                    if (!formData.name || !formData.idNumber || !formData.age || !formData.email || !formData.address) {
                        Swal.fire('Error', 'All fields are required!', 'error');
                        return false;
                    }
                    if (isNaN(formData.age) || formData.age < 18) {
                        Swal.fire('Error', 'Age must be at least 18!', 'error');
                        return false;
                    }
                    if (!/\S+@\S+\.\S+/.test(formData.email)) {
                        Swal.fire('Error', 'Invalid email!', 'error');
                        return false;
                    }
                    return true;
                }
            }));
        });
    </script>
</body>
</html>